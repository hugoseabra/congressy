{% extends "base/base.html" %}

{% load i18n static subscription_tags queryset_filter %}

{% block title %} Inscrições | Congressy{% endblock %}

{% block page_title %}Inscrições{% endblock %}

{% block page_sub_title %}
    {{ event.name }}
{% endblock %}

{% block styles %}
    <link rel="stylesheet"
          href="{% static 'assets/plugins/dataTables/css/responsive.bootstrap.min.css' %}">
    <link rel="stylesheet"
          href="{% static 'assets/plugins/dataTables/css/datatables.min.css' %}">
    <link rel="stylesheet"
          href="{% static 'assets/plugins/icheck/css/all.css' %}">
    <link rel="stylesheet"
          href="{% static 'assets/plugins/dataTables/css/responsive.dataTables.min.css' %}">


{% endblock %}

{% block scripts %}
    <!--ABSTRACTS DEPENDENCIES-->
    <script src="{% static "assets/js/ajax.js" %}"></script>
    <script src="{% static "assets/js/messenger.js" %}"></script>
    <script src="{% static "assets/js/vendor/moment.js" %}"></script>
    <script src="{% static "assets/js/price-format.min.js" %}"></script>

    <!--ABSTRACTS-->
    {% if DEBUG is True and STAGING_MODE is False %}
    <script src="{% static "assets/js/abstracts/01-dom.js" %}"></script>
    <script src="{% static "assets/js/abstracts/01-error.js" %}"></script>
    <script src="{% static "assets/js/abstracts/01-messenger.js" %}"></script>
    <script src="{% static "assets/js/abstracts/01-uri.js" %}"></script>
    <script src="{% static "assets/js/abstracts/02-alerter.js" %}"></script>
    <script src="{% static "assets/js/abstracts/02-form-field-mapper.js" %}"></script>
    <script src="{% static "assets/js/abstracts/02-http.js" %}"></script>
    <script src="{% static "assets/js/abstracts/03-form.js" %}"></script>
    <script src="{% static "assets/js/abstracts/03-model.js" %}"></script>
    <script src="{% static "assets/js/abstracts/04-collection.js" %}"></script>
    <script src="{% static "assets/js/abstracts/04-model-form.js" %}"></script>
    <script src="{% static "assets/js/abstracts/05-element-list.js" %}"></script>
    <script src="{% static "assets/js/abstracts/05-modal.js" %}"></script>

    {% else %}
        <script src="{% static "assets/js/abstracts/cgsy-abstracts.js" %}?v=1"></script>
    {% endif %}


    <script src="{% static 'assets/plugins/dataTables/js/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'assets/plugins/dataTables/js/dataTables.responsive.min.js' %}"></script>

    <script src="{% static 'assets/plugins/dataTables/js/dataTables.bootstrap.min.js' %}"></script>

    <script src="{% static 'assets/plugins/dataTables/js/responsive.bootstrap.min.js' %}"></script>

    <script src="{% static 'assets/plugins/icheck/js/icheck.min.js' %}"></script>

    {% if event.feature_configuration.feature_checkin is True %}
    <script src="{% static "assets/js/attendance/attendance.js" %}"></script>
    <script>
        var ACCREDITATION_SERVICE_ID = '';
        var priting_webhook_url = '';
        var priting_pin = '';

        {% if accreditation_service %}
        ACCREDITATION_SERVICE_ID = '{{ accreditation_service.pk }}';
        {% if accreditation_service.printing_queue_webhook %}
            priting_webhook_url = '{{ accreditation_service.printing_queue_webhook }}';
            priting_pin = '{{ accreditation_service.pwa_pin }}';
        {% endif %}

        var printer_config_key = 'cgsy-printer-config-' + '{{ event.pk }}';
        function savePrinterConfig(service_pk, printer_number) {
            var data = {
                'service_pk': service_pk,
                'event_pk': parseInt('{{ event.pk }}'),
                'printer_number': parseInt(printer_number)
            };
            localStorage.setItem(printer_config_key, JSON.stringify(data));

            var messenger = new window.cgsy.abstracts.messenger.Messenger();
            messenger.notifySuccess('Configurações salvas com sucesso');
            setConfigToAttendanceForm();
        }

        function getPrinterConfig() {
            var config = localStorage.getItem(printer_config_key);
            if (!config) {
                return;
            }
            return JSON.parse(config);
        }

        function setConfigToAttendanceForm() {
            var config = getPrinterConfig() || {};
            var service_pk = config.hasOwnProperty('service_pk') ? config['service_pk'] : null;
            var printer_number = config.hasOwnProperty('printer_number') ? config['printer_number'] : 1;

            if (service_pk) {
                $('#config-default-service').val(service_pk);
                $('#attendance_id').val(service_pk);
            }

            $('#config-printer-number').val(printer_number);
        }

        var registerAccreditation = function(button_el, procced_printing) {
            procced_printing = procced_printing === true;

            if (!ACCREDITATION_SERVICE_ID) {
                return;
            }

            var data = button_el.data();
            var pk = data['pk'];
            var name = data['person_name'];
            var lot_name = data['lot_name'];
            var category_name = data['category_name'];
            var email = data['person_email'];
            var event_count = data['event_count'];
            var code = data['code'];
            var status = data['status'];
            var attended = data['attended'];

            var options = {
                'checkinUri': "{% url 'api:attendance:checkin-list' %}",
                'success_checkin_msg': 'Atendimento registrado com succeso',
                'fail_checkin_msg': 'Falha ao registrar atendimento',
                'checkoutUri': "{% url 'api:attendance:checkout-list' %}",
                'success_checkout_msg': 'Saída de atendimento registrada com sucesso',
                'fail_checkout_msg': 'Falha ao registrar saída'
            };

            var attendance = new window.cgsy.attendance.Attendance(
                options['checkinUri'],
                options['success_checkin_msg'],
                options['fail_checkin_msg'],
                options['checkoutUri'],
                options['success_checkout_msg'],
                options['fail_checkout_msg']
            );

            var subscription = new window.cgsy.attendance.Subscription(
                pk,
                name,
                lot_name,
                category_name,
                email,
                event_count,
                code,
                status,
                attended
            );

            subscription.setUri("/api/attendance/services/"+ ACCREDITATION_SERVICE_ID +"/subscriptions/:pk/");

            attendance.checkin(ACCREDITATION_SERVICE_ID, subscription, name).then(function() {
                if (procced_printing) {
                    triggerPrintWebhook(ACCREDITATION_SERVICE_ID, pk, priting_webhook_url, printing_pin).then(function() {
                        alert('bla');
                    });
                } else {
                    var parent = button_el.parent();
                    parent.append(getAccreditationInfo())
                }
            });
        };

        function triggerPrintWebhook(service_pk, sub_pk, printing_webhook, pin) {
            return new Promise(function(resolve, reject) {

                var printer_number  = 1;

                var config = getPrinterConfig();
                if (config && config.hasOwnProperty('printer_number')) {
                    printer_number = parseInt(config['printer_number']) || 1;
                }

                var data = {
                    'event_id': parseInt('{{ event.pk }}'),
                    'service_id': parseInt(service_pk),
                    'subscription_id': sub_pk,
                    'printer_number': printer_number
                };

                var messenger = new window.cgsy.abstracts.messenger.Messenger();

                var sender = new window.cgsy.AjaxSender(printing_webhook + '/queues/items');
                    sender.addHeader('PIN', pin);
                    sender.crossDomainMode();
                    sender.payloadMode();

                sender.setFailCallback(function() {
                    messenger.notifyError('Não foi possível registrar impressão do atendimento');
                    reject();
                });
                sender.setSuccessCallback(function() {
                    messenger.notifySuccess('Impressão enviada com sucesso.');
                    resolve();
                });
                sender.post(data);
            });
        }

        {% endif %}
    </script>
    {% endif %}

    <script>
        var customCheckbox = function () {
            $('input.icheck').iCheck({
                checkboxClass: 'icheckbox_flat-green',
                radioClass: 'iradio_flat-blue'
            });
        };

        var get_status_el = function (data, row) {


            var status;

            switch (row.status) {
                case 'confirmed':
                    status = $('#confirmed').clone();
                    break;
                case 'awaiting':
                    status = $('#awaiting').clone();
                    break;
                case 'canceled':
                    status = $('#canceled').clone();
                    break;
                default:
                    console.error("Status desconhecido de inscrição: " + row.status);
                    return;
            }


            status.remove('id');
            status.show();

            return status.prop('outerHTML');


        };

        var get_name_as_link_el = function (data, row) {

            var tag = document.createElement("a");

            tag = $(tag);
            tag.append(data).attr("href", row['link']);


            return tag.prop('outerHTML');

        };

        var get_date_el = function (row) {
            var tag = document.createElement("div");
            tag = $(tag);
            tag.css("margin-left", '18px');

            var span = $(document.createElement('small'));
            span.addClass('text-muted');

            span.append(new Date(row['created']).toLocaleString());

            tag.append(span);
            return tag.prop('outerHTML');

        };

        var get_institution_el = function (row) {
            var tag = document.createElement("div");
            tag = $(tag);
            tag.css("margin-left", '18px');

            var span = $(document.createElement('small'));
            span.addClass('text-muted');

            span.append(row['institution']);

            tag.append(span);
            return tag.prop('outerHTML');
        };

        var get_origin_badge_el = function (row) {

            var tag = document.createElement("div");
            tag = $(tag);
            tag.css("margin-left", '18px');

            var span = $(document.createElement('span'));
            span.addClass('badge badge-info');

            if (row['origin'] === 'manage') {
                span.append('Interno');
                tag.append(span);
                return tag.prop('outerHTML');

            } else if (row['origin'] === 'csv_import') {
                span.append('CSV');
                tag.append(span);
                return tag.prop('outerHTML');
            }

            return ''
        };

        var get_code_badge_el = function (row) {

            var span = $('<span>').addClass('badge badge-info');
            span.text(row['code']);

            var tag = $('<div>').css("margin-left", '18px');
            tag.append(span);

            return tag.prop('outerHTML');
        };

        var get_test_badge_el = function (row) {

            var tag = document.createElement("div");
            tag = $(tag);
            tag.css("margin-left", '18px');

            var span = $(document.createElement('span'));
            span.addClass('badge badge-warning');

            if (row['test_subscription']) {
                span.append('Inscrição de teste');
                tag.append(span);
                return tag.prop('outerHTML');

            }

            return ''
        };

        var get_dropdown_btn = function (row) {

            var main = $('#drop_down_btn').clone();
            main.remove("id");


            main.find("#link").attr("href", row['link']).remove("id");
            var edit_link = main.find("#edit_link");
            edit_link.attr("href", row['edit_link']).remove("id");


            if (row['status'] === 'confirmed') {
                var voucher_link = main.find("#voucher_link");
                voucher_link.attr("href", row['voucher_link']).show().remove("id");
            }

            main.show();
            return main.prop('outerHTML');
        };

        var get_hidden_person = function (row) {

            var tag = document.createElement("div");

            tag = $(tag);
            tag.hide();

            var f = [
                'person_cpf',
                'person_city',
                'person_uf',
                'person_phone',
                'person_city_international',
                'person_international_doc'
            ];


            var i;

            for (i = 0; i < f.length; i++) {

                var p = document.createElement("p");
                p = $(p);
                p.append(row[f[i]]);

                tag.append(p)
            }


            return tag.prop('outerHTML');


        };

        var getAccreditationInfo = function(row) {

            var output = '';


            var printer_list = $('<select>').attr({
                'class': 'form-control form-control-sm printer-number-' + row['code'],
                'data-toggle': 'tooltip',
                'data-placement': 'bottom',
                'title': 'Número da impressora',
                'style': 'display:none'
            });

            for (var a = 1; a <= 15; a++) {
                var o = $('<option>').attr('value', a).text(a);
                printer_list.append(o)
            }

            if (row['accredited'] === false) {

                output += '<div>';
                output += '<button class="btn btn-sm btn-block btn-success"' +
                    ' data-pk="'+row['pk']+'"' +
                    ' data-person_name="'+row['person_name']+'"' +
                    ' data-lot_name="'+row['lot_name']+'"' +
                    ' data-category_name="'+row['category_name']+'"' +
                    ' data-person_email="'+row['person_email']+'"' +
                    ' data-event_count="'+row['event_count']+'"' +
                    ' data-code="'+row['code']+'"' +
                    ' data-status="'+row['status']+'"' +
                    ' onclick="registerAccreditation($(this))">Registrar</div>';


                if (priting_webhook_url) {
                    output += '<button class="btn btn-sm btn-block btn-success btn-trans">Registrar e imprimir</button>';
                }

                output += '<button class="btn btn-sm btn-block btn-danger btn-trans">Cancelar</button>';
                output += '</div>';

                if (priting_webhook_url) {
                    output += '<div class="text-center">';
                    output += '<a href="javascript:void(0)" onclick="$(this).hide();$(\'.printer-number-' + row['code'] + '\').show();">';
                    output += '<div style="margin-top:10px;"></div>';
                    output += '<strong data-toggle="tooltip" data-placement="bottom" title="Número da impressora" style="border:1px solid lightgray;padding:6px;border-radius:2px">1</strong>';
                    output += '</a>';
                    output += printer_list.prop('outerHTML');
                    output += '</div>';
                }

                return output;
            }

            if (row['accredited_on']) {
                var date = new Date(row['accredited_on']);

                output += '<div>';
                output += '<span class="text-bold">Data:</span> ';
                output += date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
                output += '</div>';

                if (ACCREDITATION_SERVICE_ID && priting_webhook_url) {
                    output += '<hr />';
                }
            }

            if (ACCREDITATION_SERVICE_ID && priting_webhook_url) {
                output += '<div>';
                output += '<div class="float-left" style="margin-left:69px">';
                output += '<a href="javascript:void(0)" data-toggle="tooltip" data-placement="bottom" title="Reimprimir" onclick="$(this).hide();$(this).parent().parent().find(\'i.fa-spinner\').show()">';
                output += '<i class="fas fa-print fa-2x"></i>';
                output += '</a>';
                output += '<i class="fas fa-spinner fa-spin fa-2x" style="display:none"></i>';
                output += '&ensp;';
                output += '</div>';
                output += '<div class="float-right input-group input-group-sm" style="margin-right:17px;margin-top:4px">';
                output += '<a href="javascript:void(0)" onclick="$(this).hide();$(\'.printer-number-' + row['code'] + '\').show()">';
                output += '<strong data-toggle="tooltip" data-placement="bottom" title="Número da impressora" style="border:1px solid lightgray;padding:6px;border-radius:2px">1</strong>';
                output += '</a>';
                output += printer_list.prop('outerHTML');
                output += '</div>';
                output += '<div class="clearfix"></div>';
                output += '</div>';
            }

            return output;
        };

        $(document).ready(function () {
            customCheckbox();

            var lots = {% jsonify lots %};

            var url = '{% url 'api:subscription:subscription-list-api' event.pk %}';

            var table = $('#subscription_table').DataTable({
                "processing": true,
                "serverSide": true,
                "lengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                "pageLength": 10,
                "searchDelay": 500,
                "ajax": function (data, callback, settings) {

                    var tag_group = $('#tag_group_filter option:selected').val();
                    var category = $('#category_filter option:selected').val();
                    var lot = $('#lot_filter option:selected').val();


                    var payload = {
                        limit: data.length,
                        offset: data.start,
                        filter_by: settings.aaSorting[0][0],
                        dir: settings.aaSorting[0][1],
                        search: data.search['value']
                    };


                    if (tag_group !== "---") {
                        payload['tag_group'] = tag_group
                    }

                    if (category !== "---") {
                        payload['category'] = category
                    }

                    if (lot !== "---") {
                        payload['lot'] = lot
                    }


                    $.ajax({
                        url: url,
                        data: payload,
                        success: function (res) {
                            callback(res);
                        }
                    });


                },
                "fnRowCallback": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {

                    if (aData['category_name']) {
                        $("td:eq(3)", nRow).attr("data-toggle", "tooltip").attr("title", aData['category_name']);
                    }

                },
                "drawCallback": function( settings ) {
                    $('.accredited').popover({'html': true});
                    $('.not-accredited').popover({'html': true});
                },
                // constract columns
                columns: [
                    {
                        data: 'person_name', "render": function (data, type, row, meta) {
                            var statusBall = get_status_el(data, row);
                            var nameWithLink = get_name_as_link_el(data, row);
                            var dateCreated = get_date_el(row);
                            var institution = get_institution_el(row);
                            var testBage = get_test_badge_el(row);
                            var badge = get_origin_badge_el(row);
                            var code = get_code_badge_el(row);

                            return statusBall
                                + '&nbsp;'
                                + nameWithLink
                                + testBage
                                + badge
                                + code
                                + institution
                                + dateCreated;
                        }
                    },
                    {
                        data: 'code', "render": function (data, type, row, meta) {


                            var hidden = get_hidden_person(row);

                            return data + hidden
                        }
                    },
                    {
                        data: 'accredited', "render": function (data, type, row, meta) {

                            if (!ACCREDITATION_SERVICE_ID) {
                                return '-';
                            }

                            var a;
                            var icon = $('<span>').addClass('fas fa-2x');
                            if (row['accredited'] === false) {
                                icon.addClass('fa-minus-circle').css('color', 'gray');
                                icon.attr({
                                    'data-toggle': 'tooltip',
                                    'title': 'Não credenciado'
                                });

                                a = $('<a>').attr({
                                    'href': 'javascript:void(0)',
                                    'data-toggle': 'popover',
                                    'data-placement': 'bottom',
                                    'title': 'Credenciamento',
                                    'data-content': getAccreditationInfo(row)
                                });

                                a.addClass('not-accredited');
                                a.append(icon);

                                return a.prop('outerHTML');
                            }

                            icon.addClass('fa-check-circle').css('color', 'green');
                            icon.attr({
                                'data-toggle': 'tooltip',
                                'title': 'Credenciado'
                            });

                            a = $('<a>').attr({
                                'href': 'javascript:void(0)',
                                'data-toggle': 'popover',
                                'data-placement': 'bottom',
                                'title': 'Credenciamento',
                                'data-content': getAccreditationInfo(row)
                            });
                            a.addClass('accredited');
                            a.append(icon);

                            return a.prop('outerHTML');
                        }
                    },
                    {data: 'lot_name'},
                    {data: 'event_count'},
                    {
                        data: 'link', "render": function (data, type, row, meta) {
                            return get_dropdown_btn(row);

                        }
                    }
                ],
                "language": {
                    sEmptyTable: "Nenhum registro encontrado",
                    sInfo: "Mostrando de _START_ até _END_ de _TOTAL_ registros",
                    sInfoEmpty: "Mostrando 0 até 0 de 0 registros",
                    sInfoFiltered: "(Filtrados de _MAX_ registros)",
                    sInfoPostFix: "",
                    sInfoThousands: ".",
                    sLengthMenu: "_MENU_ resultados por página",
                    sLoadingRecords: "Carregando...",
                    sProcessing: "Processando...",
                    sZeroRecords: "Nenhum registro encontrado",
                    sSearch: "Pesquisar",
                    oPaginate: {
                        sNext: "Próximo",
                        sPrevious: "Anterior",
                        sFirst: "Primeiro",
                        sLast: "Último"
                    },
                    oAria: {
                        sSortAscending: ": Ordenar colunas de forma ascendente",
                        sSortDescending: ": Ordenar colunas de forma descendente"
                    }
                },
                "columnDefs": [
                    // Disable sort in first, last column
                    {
                        "searchable": false,
                        "orderable": false,
                        "targets": [-1]
                    },
                    {
                        "targets": 1,
                        "orderable": false
                    },
                    {
                        "targets": 2,
                        "orderable": false,
                        "class": "text-center"
                    },
                    {
                        "targets": 4,
                        "orderable": true,
                        "class": "text-center"
                    },
                    {
                        "targets": 5,
                        "orderable": true,
                        "type": 'date-euro'
                    }
                ],
                // Default order
                "order": [[0, 'asc']],
                responsive: true
            });

            $('#tag_group_filter,#category_filter,#lot_filter').on("change", function () {
                table.ajax.reload();
            });

            $('#category_filter').on("change", function () {

                var select = $("#lot_filter");

                select.empty()
                    .append('<option selected>---</option>');

                var id = $(this).val();

                if (lots.hasOwnProperty(id)) {

                    Object.keys(lots[id]).forEach(function (k) {
                        select.append($("<option>").val(k).html(lots[id][k]));
                    });

                } else {
                    console.log('Nenhum lote.')
                }
            });
        });

    </script>
{% endblock %}

{% block content %}


    <i id="confirmed" class="fa fa-circle" data-toggle="tooltip" data-placement="right"
       style="color:#5cb85c; display: none;"
       data-original-title="Status: confirmado" aria-hidden="true"></i>

    <i id="awaiting" class="fa fa-circle"
       data-toggle="tooltip"
       data-placement="right"
       data-original-title="Status: pendente"
       aria-hidden="true"
       style="color: #f0ad4e;display: none;"></i>
    <i id="canceled" class="fa fa-circle"
       data-toggle="tooltip"
       data-placement="right"
       data-original-title="Status: cancelado"
       aria-hidden="true"
       style="color: #d9534f;display: none;"></i>


    <div id="drop_down_btn" class="btn-group" style="display:none;">
        <button
                type="button"
                class="btn btn-primary btn-trans btn-sm dropdown-toggle"
                data-toggle="dropdown"
                aria-expanded="false">
            <span class="fas fa-cog"></span>
        </button>
        <ul class="dropdown-menu dropdown-menu-right"
            role="menu">
            <li>
                <a id="link">
                    <i class="fa fa-eye"></i>
                    Visualizar
                </a>
            </li>
            {% if event.allow_internal_subscription %}
                <li>
                    <a id="edit_link">
                        <i class="fas fa-pencil-alt"></i>
                        Editar
                    </a>
                </li>
            {% endif %}

            <li>
                <a id="voucher_link" style="display: none">
                    <i class="fas fa-file-pdf"></i>
                    Voucher
                </a>
            </li>

        </ul>
    </div>



    <div class="row">
        <div class="col-md-12">
            <div class="buttonbar">
                <div class="float-left">
                    <button type="button"
                            class="btn btn-primary {% if not has_subs %}disabled{% endif %}"
                            {% if not has_subs %}disabled
                            title="Nenhuma inscrição para exportar."{% endif %}
                            onclick="$('#export-form').submit();">
                        <i class="fa fa-download"></i>
                        Exportar
                    </button>
                    <div style="display:none">
                        <form action="{% url 'subscription:subscriptions-export' event.pk %}"
                              method="post" id="export-form">
                            {% csrf_token %}
                        </form>
                    </div>
                </div>

                <div class="float-right">
                    {% if event.feature_configuration.feature_import_via_csv %}
                        <a href="{% url 'importer:csv-list' event.pk %}"
                           class="btn btn-primary">
                            <i class="fas fa-file-excel"></i>
                            Importar via CSV
                        </a>
                    {% endif %}
                    {% if event.feature_configuration.feature_internal_subscription %}
                        <a role="button" class="btn btn-success"
                           href="{% url 'subscription:subscription-add' event.pk %}">
                            <i class="fa fa-plus"></i>
                            Nova inscrição
                        </a>
                    {% endif %}
                </div>

                <div class="clearfix"></div>
            </div>
        </div>
    </div>

    {% if has_filter %}
        <div class="row tooltip-wrapper">

            <div class="col-md-12">

                <div class="panel panel-primary">

                    <div class="panel-body">


                        <div class="col-md-12">

                            <div>

                                <span style="font-weight: bold; font-size: 17px">Filtros:</span>

                                <form class="form">
                                    <div class="form-group row">

                                        {% if group_tags|length > 0 %}



                                            <div class="col-xs-3">
                                                <label class="control-label">Tag de Agrupador:</label>
                                                <select class="form-control input-sm" id="tag_group_filter">
                                                    <option selected>---</option>
                                                    {% for tag in group_tags %}
                                                        <option value="{{ tag }}">{{ tag }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>



                                        {% endif %}


                                        {% if categories|length > 0 %}



                                            <div class="col-xs-3">

                                                <label class="control-label">Categorias:</label>
                                                <select class="form-control input-sm" id="category_filter">
                                                    <option selected>---</option>
                                                    {% for category_name, category_pk in categories.items %}
                                                        <option value="{{ category_pk }}">{{ category_name }}</option>
                                                    {% endfor %}
                                                </select>

                                            </div>


                                            <div class="col-xs-3">

                                                <label class="control-label">Lotes:</label>
                                                <select class="form-control input-sm" id="lot_filter">
                                                    <option selected>---</option>
                                                </select>

                                            </div>



                                        {% endif %}


                                    </div>

                                </form>

                            </div>

                        </div>


                    </div>

                </div>

            </div>

        </div>
    {% endif %}


    <div class="row tooltip-wrapper">

        <div class="col-md-12">

            <div class="panel panel-primary">

                <div class="panel-body">

                    <div class="col-md-12 table-responsive">


                        <table id="subscription_table"
                               class="table table-striped table-bordered"
                               cellspacing="0">

                            <thead>

                            <tr>

                                <th>Nome do Participante</th>

                                <th width="10%">Código</th>
                                <th width="10%">Credenciado</th>

                                <th width="18%">Lote</th>

                                <th width="10%" class="text-center"># Insc.</th>

                                <th class="text-center" width="5%"></th>

                            </tr>

                            </thead>
                        </table>
                    </div>


                </div>

            </div>

        </div>

    </div>

{% endblock %}