{% extends "base/base.html" %}
{% block title %} Pré-inscrições | Congressy{% endblock %}
{% load i18n static %}

{% block pageheader %}
    <div class="pageheader">
        <h1>Pré-inscrições</h1>
    </div>
{% endblock %}
{% block nav_aside_itens %}
    <li>
        <a href="{% url 'event:event-panel' event.pk %}" title="Voltar">

            <i class="fa  fa-fw fa-arrow-left icon-large"></i> Voltar
        </a>
    </li>
    <hr/>
    {{ block.super }}
{% endblock %}
{% block content %}
    <div class="row">
        <div class="col-md-12">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <h3 class="panel-title">{{ event.name }} {% if not event.published %}
                        <i style="color: darkgrey">- não publicado</i>{% endif %}</h3>
                </div>
                <div class="panel-body">

                    <div style="margin-bottom:10px; padding: 10px;background-color: #DDDDDD;text-align: center;">
                        {% if can_add_subscription %}
                            <a href="{% url 'subscription:subscription-add' event.pk %}">Adicionar</a>
                        {% else %}
                            <span style="font-weight: bold">Lotes não disponíveis.</span>
                        {% endif %}
                    </div>



                    {% if event.subscription_type == event.SUBSCRIPTION_BY_LOTS %}
                        <div style="float:left;width:10%;margin-right:1px">
                            <div style="background: #DDD;padding: 8px">
                                <div>
                                    <strong>FILTRO: </strong>
                                </div>
                            </div>
                            <div style="padding:8px;">
                                <strong>Lotes:</strong>
                                <table width="100%" border="0" cellspacing="0" cellpadding="0">
                                    {% for lot in event.lots.all|dictsort:"name" %}
                                        <tr>
                                            <td width="5%" style="text-align: center">
                                                <input type="checkbox" name="lot_{{ lot.pk }}"/>
                                            </td>
                                            <td>{{ lot.name }}</td>
                                        </tr>
                                    {% endfor %}
                                </table>
                            </div>
                        </div>
                        <div style="float:right;width:89.5%">
                    {% else %}
                        <div style="float:right;width:100%">
                    {% endif %}




                    {% if object_list %}
                        <div class="table-responsive">
                            <table id="sub_table" class="table table-hover">
                                <thead>
                                <tr>
                                    <th># ID</th>
                                    <th>Nome do Participante</th>
                                    <th>Cód. Inscrição</th>
                                    <th>Perfil</th>
                                    <th></th>
                                </tr>
                                </thead>

                                <tbody>
                                {% for item in object_list %}
                                    <tr>
                                        <td>
                                            {{ forloop.counter }}
                                        </td>
                                        <td>
                                            <a href="{% url 'subscription:subscription-edit' event.pk item.pk %}">
                                                {{ item.person.name }}
                                            </a>
                                             <div class="text-muted">{{ item.created }}</div>
                                        </td>
                                        <td>
                                            {{ item.code }}
                                        </td>
                                        <td>
                                            {% if item.person.user_id %}
                                                &#10004;
                                            {% endif %}
                                        </td>
                                        <td>
                                            <a href="{% url 'subscription:subscription-edit' event.pk item.pk %}">Editar</a>
                                            &nbsp;
                                            <a href="{% url 'subscription:subscription-delete' event.pk item.pk %}">Excluir</a>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div style="background: #FFF;padding:10px;margin-bottom: 3px">
                            Nenhuma pré-inscrição
                        </div>
                    {% endif %}



                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


{% endblock %}

{% block scripts %}
    {{ block.super }}

    <script>
        $(document).ready(function () {
            $('#sub_table').DataTable();
        });
    </script>
{% endblock %}
